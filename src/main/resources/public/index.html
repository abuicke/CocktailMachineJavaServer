<!DOCTYPE html>
<html>
    <body>
        <h1>Cocktail Machine System Monitor</h1>
        <script>
            const listenForSystemEvents = function() {
                const xmlHttpRequest = new XMLHttpRequest()
                const url = 'http://192.168.0.15/get_last_system_event'
                xmlHttpRequest.open("GET", url)
                xmlHttpRequest.send()
                xmlHttpRequest.onreadystatechange = function() {
                    if(this.readyState == 4 && this.status == 200) {
                        const systemEvent = JSON.parse(xmlHttpRequest.responseText)
                        if(systemEvent.name) {
                            console.log("systemEvent = " + systemEvent.name)
                            const p = document.createElement("p")
                            if(systemEvent.isError) {
                                p.style.color = "red"
                            }
                            p.innerHTML = systemEvent.name
                            document.body.appendChild(p)
                        }
                        window.setTimeout(listenForSystemEvents, 100)
                    }
                }
            }
            listenForSystemEvents()
        </script>
    </body>
</html>